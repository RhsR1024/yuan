ğŸ–•æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·â€œå½¤å“¥è¯»æºç â€ï¼ŒæŸ¥çœ‹æ›´å¤šæºç ç³»åˆ—æ–‡ç« , ä¸å½¤å“¥ä¸€èµ·ç•…æ¸¸æºç çš„æµ·æ´‹ã€‚ 

---

## èƒŒæ™¯

æ˜¨å¤©ï¼Œåœ¨é€›è®ºå›æ—¶é‡åˆ°ä¸ªè¿™ä¹ˆä¸ªé—®é¢˜ï¼Œä¸Šä»£ç ï¼š

```java
public class GenericTest {
    //æ–¹æ³•ä¸€
    public static <T extends Comparable<T>> List<T> sort(List<T> list) {
        return Arrays.asList(list.toArray((T[]) new Comparable[list.size()]));
    }

    //æ–¹æ³•äºŒ
    public static <T extends Comparable<T>> T[] sort2(List<T> list) {
        // è¿™é‡Œæ²¡æŠ¥é”™
        return list.toArray((T[]) new Comparable[list.size()]);
    }

    public static void main(String[] args) {
        List<Integer> list = new ArrayList<>();
        list.add(1);
        list.add(2);
        // æ–¹æ³•ä¸€è°ƒç”¨æ­£å¸¸
        System.out.println(sort(list).getClass());
        // æ–¹æ³•äºŒè°ƒç”¨æŠ¥é”™äº†ï¼Œè¿™é‡ŒæŠ¥é”™äº†
        System.out.println(sort2(list).getClass());
    }
}
```

è¿™ä¸ªé—®é¢˜æœ‰ä»¥ä¸‹å››ä¸ªç°è±¡ï¼š

ï¼ˆ1ï¼‰æ–¹æ³•ä¸€è°ƒç”¨å®Œå…¨æ­£å¸¸ï¼›

ï¼ˆ2ï¼‰æ–¹æ³•äºŒè°ƒç”¨æŠ¥é”™äº†ï¼›

ï¼ˆ3ï¼‰æ–¹æ³•äºŒæŠ¥é”™çš„åœ°æ–¹æ˜¯åœ¨`System.out.println(sort2(list).getClass());`è¿™è¡Œï¼Œè€Œä¸æ˜¯`return list.toArray((T[]) new Comparable[list.size()]);`è¿™è¡Œï¼›

ï¼ˆ4ï¼‰æŠ¥çš„é”™æ˜¯`[Ljava.lang.Comparable; cannot be cast to [Ljava.lang.Integer;`ï¼›

æ€ä¹ˆæ ·ï¼Ÿä½ å¿ƒä¸­æœ‰ç­”æ¡ˆå˜›ï¼Ÿç±»å‹æ“¦é™¤ï¼Ÿæ€ä¹ˆæ“¦ï¼Ÿæ‘©æ“¦æ‘©æ“¦ï¼Ÿ

## è§£å†³

åˆšæ‹¿åˆ°è¿™é“é¢˜ï¼Œæˆ‘ä¹Ÿæ˜¯ä¸€è„¸æ‡µé€¼ï¼Œè¿™è¦æŠ¥é”™ä¹Ÿåº”è¯¥æ˜¯åœ¨`return list.toArray((T[]) new Comparable[list.size()]);`è¿™è¡Œå•Šï¼Œè€Œä¸”è¦æŠ¥é”™åº”è¯¥ä¸¤ä¸ªæ–¹æ³•éƒ½æŠ¥é”™å•Šã€‚

æŠ±ç€ä¸æ”¾å¼ƒä¸æŠ›å¼ƒçš„å¿ƒæ€ï¼Œå½¤å“¥åšäº†å¤§é‡çš„å®éªŒï¼Œç»ˆäºå¾—å‡ºäº†æ³›å‹çš„æœ¬è´¨ï¼Œä¸”å¬æˆ‘å¨“å¨“é“æ¥ã€‚

### å°æ’æ›²

é¦–å…ˆï¼Œæˆ‘ä»¬è¦æ˜ç™½ï¼Œjavaä¸­çš„æ•°ç»„æ˜¯ä¸æ”¯æŒå‘ä¸‹è½¬å‹çš„ï¼Œä½†æ˜¯å¦‚æœæœ¬èº«å°±æ˜¯é‚£ä¸ªç±»å‹çš„æ˜¯å¯ä»¥è½¬è¿‡å»çš„ï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š

```java
public static void main(String[] args) {
    Object[] objs = new Object[]{1};
    // ç±»å‹è½¬æ¢é”™è¯¯
//  Integer[] ins = (Integer[]) objs;

    Object[] objs2 = new Integer[]{1};
    // ä¸æŠ¥é”™
    Integer[] ins2 = (Integer[]) objs2;

}

```

### ç±»å‹æ“¦é™¤

javaé‡Œçš„æ³›å‹æ˜¯å‡æ³›å‹ï¼Œåªåœ¨ç¼–è¯‘æœŸæœ‰æ•ˆï¼Œåœ¨è¿è¡Œæ—¶æ˜¯æ²¡æœ‰æ³›å‹çš„æ¦‚å¿µçš„ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š

```java
public static void main(String[] args) {
        List<String> strList = Arrays.asList("1");
        List<Integer> intList = Arrays.asList(1);

        // æ‰“å°ï¼štrue
        System.out.println(strList.getClass() == intList.getClass());
    }
```

å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªlistçš„ç±»å‹æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœä½ è§‰å¾—è¿™ä¸ªä¾‹å­ä¸å¤Ÿè¯´æœåŠ›ï¼Œé‚£æˆ‘ç»™ä½ ä¸ªè¿‡åˆ†ç‚¹çš„ä¾‹å­ï¼š

```java
public static void main(String[] args) throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {
    List<String> strList = new ArrayList<>();

    Method addMethod = strList.getClass().getMethod("add", Object.class);
    addMethod.invoke(strList, 1);
    addMethod.invoke(strList, true);
    addMethod.invoke(strList, new Long(1));
    addMethod.invoke(strList, new Byte[]{1});

    // æ‰“å°ï¼š[1, true, 1, 1]
    System.out.println(strList);
}
```

ç§ï¼Œæˆ‘å¯ä»¥å¾€ä¸€ä¸ªStringç±»å‹çš„Listä¸­æ‰”ä»»ä½•æˆ‘æƒ³æ‰”çš„ä¸œè¥¿ï¼Œæœä¸æœï¼Ÿï¼

æ‰€ä»¥è¯´javaé‡Œé¢çš„æ³›å‹æ˜¯å‡çš„ï¼Œè¿è¡Œæ—¶ä¸å­˜åœ¨æ»´ã€‚

### å›å½’æ­£é¢˜

æ•°ç»„ä¸èƒ½å‘ä¸‹å¼ºè½¬æˆ‘æ‡‚äº†ï¼Œç±»å‹æ“¦é™¤æˆ‘ä¹Ÿæ‡‚äº†ï¼Œä¼¼ä¹è¿˜æ˜¯è¿‡ä¸å¥½è¿™ä¸€ç”Ÿï¼Œå‘ƒä¸æ˜¯ï¼Œæ˜¯è¿˜æ˜¯è§£å†³ä¸äº†è¿™é“é¢˜å•Šï¼Ÿ

å‘ƒï¼Œå¥½åƒæ˜¯~~

æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š

```java
// GenericTest2.javaï¼ˆæºç ï¼‰
public class GenericTest2 {
    public static void main(String[] args) {
        System.out.println(raw("1"));
    }

    public static <T> T raw(T t) {
        return t;
    }
}
// GenericTest2.classï¼ˆåç¼–è¯‘ï¼‰
public class GenericTest2 {
    public GenericTest2() {
    }

    public static void main(String[] args) {
        System.out.println((String)raw("1"));
    }

    public static <T> T raw(T t) {
        return t;
    }
}
```

å—¯~ä¼¼ä¹çœ‹å‡ºæ¥ç‚¹ç«¯å€ªï¼Œåç¼–è¯‘åå¤šäº†ä¸ªæ„é€ æ–¹æ³•ã€‚

å‘ƒï¼Œæ²¡é”™ã€‚è¿˜æœ‰å‘¢ï¼Ÿ

ä»”ç»†ä¸€çœ‹ï¼Œ`System.out.println((String)raw("1"));`è¿™ä¸€å¥å¤šåŠ äº†ä¸ªStringå¼ºè½¬ã€‚

è¿™å°±æ˜¯å…³é”®æ‰€åœ¨ï¼Œç»“åˆç±»å‹æ“¦é™¤ï¼Œè¿è¡Œæ—¶å¹¶æ²¡æœ‰æ‰€è°“çš„æ³›å‹ï¼Œæ‰€ä»¥raw()è¿”å›çš„å…¶å®æ˜¯Objectï¼Œä½†æ˜¯è°ƒç”¨è€…è‡ªå·±çŸ¥é“æˆ‘è¦çš„æ˜¯Stringç±»å‹å•Šï¼Œæ‰€ä»¥æˆ‘å°±çŸ¥é“å¼ºè½¬ä¸€ä¸‹å–½ã€‚

æˆ‘ä»¬å†æ¥çœ‹ä¸ªæç«¯çš„ä¾‹å­ï¼š

```java
// GenericTest2.javaï¼ˆæºç ï¼‰
public class GenericTest2 {
    public static void main(String[] args) {
        System.out.println(raw("1"));
    }

    public static <T> T raw(T t) {
        return (T)new Integer(1);
    }
}
// GenericTest2.classï¼ˆåç¼–è¯‘ï¼‰
public class GenericTest2 {
    public GenericTest2() {
    }

    public static void main(String[] args) {
        System.out.println((String)raw("1"));
    }

    public static <T> T raw(T t) {
        return new Integer(1);
    }
}
```

ä»”ç»†è§‚å¯Ÿï¼Œå¯ä»¥å‘ç°ï¼Œraw()æ–¹æ³•é‡Œçš„å¼ºè½¬`(T)new Integer(1)`å˜æˆäº†`new Integer(1)`ï¼Œå¼ºè½¬è¢«æ“¦é™¤äº†ï¼Œå®é™…ä¸Šåœ¨è¿è¡Œæ—¶è¿™é‡Œçš„Tå˜æˆäº†Objectï¼Œæ‰€æœ‰ç±»å‹éƒ½æ˜¯Objectçš„å­ç±»ï¼Œä¹Ÿå°±ä¸éœ€è¦å¼ºè½¬äº†ã€‚

è€Œ`(String)raw("1")`çš„å¼ºè½¬è¿˜æ˜¯åŠ ä¸Šçš„ï¼Œè¿™æ˜¯è°ƒç”¨è€…çŸ¥é“ç±»å‹æ˜¯Stringï¼Œæ‰€ä»¥raw()è¿”å›åè‡ªå·±å¼ºè½¬æˆStringä¸€ä¸‹ã€‚

å½“ç„¶ï¼Œè¿™ä¸ªä»£ç è¿è¡Œæ˜¯ä¼šæŠ¥é”™çš„ï¼Œ`java.lang.Integer cannot be cast to java.lang.String`ï¼Œå› ä¸ºraw()è¿”å›çš„æ˜¯Integerç±»å‹ï¼Œå¼ºè½¬æˆStringç±»å‹å¤±è´¥äº†ã€‚

å¥½äº†ï¼ŒåŸºæœ¬æ€è·¯å°±æ˜¯è¿™æ ·ã€‚

### æ³›å‹ç±»å‘¢ï¼Ÿ

æˆ‘ä»¬ä¸Šé¢ä¸¾çš„ä¾‹å­éƒ½æ˜¯æ³›å‹æ–¹æ³•ï¼Œé‚£ä¹ˆæ³›å‹ç±»å‘¢ï¼Ÿ

åŒæ ·åœ°ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸ªä¾‹å­ï¼š

```java
// GenericTest3.javaï¼ˆæºç ï¼‰
public class GenericTest3 {
    public static void main(String[] args) {
        System.out.println(new Raw<String>().raw("1"));
    }
}
class Raw<T> {
    public T raw(T t) {
        return (T)new Integer(1);
    }
}
// GenericTest3.classï¼ˆåç¼–è¯‘ï¼‰
public class GenericTest3 {
    public GenericTest3() {
    }

    public static void main(String[] args) {
        System.out.println((String)(new Raw()).raw("1"));
    }
}
class Raw<T> {
    Raw() {
    }

    public T raw(T t) {
        return new Integer(1);
    }
}
```

å¯ä»¥çœ‹åˆ°ï¼Œè·Ÿæ³›å‹æ–¹æ³•çš„è¡¨ç°ä¸€æ¨¡ä¸€æ ·ã€‚å½“ç„¶ï¼Œè¿™é‡Œè¿è¡Œæ—¶ä¹Ÿä¼šæŠ¥`java.lang.Integer cannot be cast to java.lang.String`è¿™ä¸ªé”™è¯¯ã€‚

## æ€»ç»“

**javaä¸­çš„æ³›å‹åªåœ¨ç¼–è¯‘æœŸæœ‰æ•ˆï¼Œåœ¨è¿è¡Œæ—¶åªæœ‰è°ƒç”¨è€…çŸ¥é“éœ€è¦ä»€ä¹ˆç±»å‹ï¼Œä¸”è°ƒç”¨è€…è°ƒç”¨æ³›å‹æ–¹æ³•åè‡ªå·±åšå¼ºåˆ¶è½¬æ¢ï¼Œè¢«è°ƒç”¨è€…æ˜¯å®Œå…¨æ— æ„Ÿçš„ã€‚**

æ‰€ä»¥ï¼Œå‡ºç°é—®é¢˜ä¸è¦é—®è¢«è°ƒç”¨è€…ï¼Œè€Œæ˜¯è¦é—®è°ƒç”¨è€…ï¼Œä½ ä¸«æ˜¯æ€ä¹ˆè°ƒç”¨çš„ï¼Ÿï¼

### è§£ç­”å¼€ç¯‡

ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬è¿˜æ˜¯æŠŠå¼€ç¯‡çš„é—®é¢˜æ‹¿è¿‡æ¥ã€‚

```java
// GenericTest.javaï¼ˆæºç ï¼‰
public class GenericTest {
    //æ–¹æ³•ä¸€
    public static <T extends Comparable<T>> List<T> sort(List<T> list) {
        return Arrays.asList(list.toArray((T[]) new Comparable[list.size()]));
    }

    //æ–¹æ³•äºŒ
    public static <T extends Comparable<T>> T[] sort2(List<T> list) {
        // è¿™é‡Œæ²¡æŠ¥é”™
        return list.toArray((T[]) new Comparable[list.size()]);
    }

    public static void main(String[] args) {
        List<Integer> list = new ArrayList<>();
        list.add(1);
        list.add(2);
        // æ–¹æ³•ä¸€è°ƒç”¨æ­£å¸¸
        System.out.println(sort(list).getClass());
        // æ–¹æ³•äºŒè°ƒç”¨æŠ¥é”™äº†ï¼Œè¿™é‡ŒæŠ¥é”™äº†
        System.out.println(sort2(list).getClass());
    }
}
```

è¿™é‡Œä¼¼ä¹åˆä¸å¤ªä¸€æ ·ï¼Œå˜æˆäº†`<T extends Comparable<T>>`ï¼Œå…¶å®æ˜¯ä¸€æ ·çš„å•¦ï¼Œå¦‚æœå•ç‹¬å†™`<T>`æ˜¯ç›¸å½“äº`<T extends Object>`çš„ã€‚

é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±å»¶ä¼¸ä¸€ä¸‹ï¼Œè¢«è°ƒç”¨è€…æ˜¯å®Œå…¨æ— æ„Ÿçš„ï¼Œå®ƒåªèƒ½å°½åŠ›æ‹¿åˆ°å®ƒçŸ¥é“çš„ç±»å‹ï¼Œæ¯”å¦‚è¿™é‡Œå°±åªèƒ½å°½åŠ›æ‹¿åˆ°Comparableï¼Œå¦‚æœæ˜¯`<T>`æ‹¿åˆ°çš„å°±æ˜¯Objectã€‚

æ‰€ä»¥ï¼Œæ–¹æ³•äºŒè¿”å›çš„å°±æ˜¯å®æ‰“å®çš„Comparable[]ç±»å‹ï¼Œä½œä¸ºè¢«è°ƒç”¨è€…ï¼Œå®ƒä¸€ç‚¹é—®é¢˜éƒ½æ²¡æœ‰ã€‚

ä½†æ˜¯ï¼Œè°ƒç”¨æ–¹æ˜¯çŸ¥é“æˆ‘éœ€è¦çš„æ˜¯Integer[]ç±»å‹çš„ï¼Œå› ä¸ºlisté‡Œé¢æ˜¯Integerç±»å‹ï¼Œæ‰€ä»¥è¿”å›çš„åº”è¯¥æ˜¯Integer[]ç±»å‹ï¼Œæ‰€ä»¥æˆ‘å°±å¼ºè½¬å–½ï¼Œç„¶åå°±æŠ¥é”™äº†ã€‚

åˆ°åº•æ˜¯ä¸æ˜¯è¿™æ ·ï¼Ÿæˆ‘ä»¬æ¥çœ‹çœ‹åç¼–è¯‘åçš„ä»£ç ï¼š

```java
// GenericTest.classï¼ˆåç¼–è¯‘ï¼‰
public class GenericTest {
    public GenericTest() {
    }

    public static <T extends Comparable<T>> List<T> sort(List<T> list) {
        return Arrays.asList(list.toArray((Comparable[])(new Comparable[list.size()])));
    }

    public static <T extends Comparable<T>> T[] sort2(List<T> list) {
        // è¿™é‡Œä½¿ç”¨çš„æ˜¯Comparable[]å¼ºè½¬ï¼Œæ‰€ä»¥è¿”å›çš„ä¹Ÿæ˜¯å®æ‰“å®çš„Comparable[]ç±»å‹
        return (Comparable[])list.toArray((Comparable[])(new Comparable[list.size()]));
    }

    public static void main(String[] args) {
        List<Integer> list = new ArrayList();
        list.add(1);
        list.add(2);
        System.out.println(sort(list).getClass());
        // æ•°ç»„å‘ä¸‹è½¬å‹å¤±è´¥
        System.out.println(((Integer[])sort2(list)).getClass());
    }
}
```

å¯ä»¥çœ‹åˆ°ï¼Œè·Ÿæˆ‘ä»¬çš„åˆ†æå®Œå…¨ä¸€è‡´ã€‚

## ä¸€å¥è¯

**javaä¸­çš„æ³›å‹åªåœ¨ç¼–è¯‘æœŸæœ‰æ•ˆï¼Œåœ¨è¿è¡Œæ—¶åªæœ‰è°ƒç”¨è€…çŸ¥é“å®ƒè‡ªå·±éœ€è¦ä»€ä¹ˆç±»å‹ï¼Œä¸”è°ƒç”¨è€…è°ƒç”¨æ³›å‹æ–¹æ³•åè‡ªå·±åšå¼ºåˆ¶è½¬æ¢ï¼Œè¢«è°ƒç”¨è€…æ˜¯å®Œå…¨æ— æ„Ÿçš„ï¼Œè¢«è°ƒç”¨è€…åªèƒ½å°½åŠ›æ‹¿åˆ°å®ƒæ‰€çŸ¥é“çš„ç±»å‹ã€‚**

---

æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·â€œå½¤å“¥è¯»æºç â€ï¼ŒæŸ¥çœ‹æ›´å¤šæºç ç³»åˆ—æ–‡ç« , ä¸å½¤å“¥ä¸€èµ·ç•…æ¸¸æºç çš„æµ·æ´‹ã€‚

![qrcode](https://gitee.com/alan-tang-tt/yuan/raw/master/æ­»ç£•%20javaé›†åˆç³»åˆ—/resource/qrcode_small.jpg)

